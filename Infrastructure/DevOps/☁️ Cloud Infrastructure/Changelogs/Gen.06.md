# Mission Statement

This revision of our infrastructure has two major changes, firstly an environment reshuffle with an aim to significantly improve our security posture, and secondly a migration to Azure Front Door Premium for further improved security, performance, and stability.

# Security Zones

Four logical zones or boundaries will be implemented that grant or disallow access to different environments and resource types depending object sensitivity and classification. This will cover Cloud Infrastructure components only and will not include Applications deployed within those environments, for example: Production Hermes Django Admin’s access scope is defined by other departments and is not subject to the restrictions in this document.

Security Zones will be split by Subscriptions in Azure for clear indication of where these boundaries exist, Azure Active Directory Security Groups defining the individuals who will have access to these resources will be created and assigned via IAM/RBAC. These zones are as follows:

#### Core
This zone will have the most sensitive components that make up the Bink stack, access to these resources can expose data from almost any other service as all environments will use some or all of the resources provided by the ‘core’ infrastructure, resources include services such as:

-   Azure Active Directory
-   Azure Firewall
-   Azure Front Door Premium
-   Tools Cluster

While no Banking, PII, or other sensitive data exists within these services they expose a large enough risk area that we feel access must be strictly restructed to the following Job Titles with NO exceptions granted for any reason: DevOps Engineers, SecOps Engineers

#### Production

This zone will consist of anything associated with the Production infrastructure, example resources include:

-   Azure Kubernetes Service
-   Azure Database for PostgreSQL
-   Azure Cache for Redis
-   Azure Key Vault
-   Azure Storage (Including Database Backups)
-   Data Warehouse Components

Banking, PII, and other sensitive data exists within these services so access should only be granted for members of the “Core” zone and roles including Squad Tech Leads, Heads of Infrastructure, and Heads of Development. If a Squad Tech Lead is unavailable, the squad assigned DevOps Engineer will move into this supporting role. Exceptions may be granted by Change Request so long as the appropriate sign offs are given by a member of the SecOps team.

#### Sandbox

This zone will contain System Integration Testing, Operational Acceptance Testing, and User Acceptance Testing envronments such as “barclays-oat” and “lloyds-sit”. While this data is non-production in nature it’s generated by third-parties and may contain sensitive data to support required testing. As such, all members of “Production” may have access, in addition, Senior Developers from Squads may also be granted access. Exceptions may be granted by Change Request so long as the appropriate sign offs are given by a member of the SecOps team.

#### Non-Production

This zone will contain Development, Staging, and Performance testing environments. This is the most permissive environment but will only grant access to members of all three previous zones as well as Quality Assurance Engineers, Developers, and Architects.

## Security Zone to Logical Environment diagram

# Azure Front Door Premium

Azure Front Door Classic has not officially had a deprecation annoucement yet, but given the trend of Microsoft Ignite for the past three years killing legacy (Windows) products as quickly as possible, it seems likely that this will indeed happen to Front Door Classic before long. During benchmarks of the product before AFDp went GA, we saw significant performance improvements associated with the product. Making this change before the Lloyds Go-Live makes a lot of sense.

# Migration of Airbyte, Prefect, and RabbitMQ into the `tf-azurerm_environment` module

Currently, the RabbitMQ and Data Warehouse components exist outside the core Envrionment module, this is because of a path of least resistance approach when it came to including them in a mid generational cycle change. The Environment Virtual Network is made up of a `/24` and currently has two `/27`'s in it, a `/27` is more than enough for these components and still gives us plenty of room for future expansion.

## RabbitMQ

Every environment will have 3 x RabbitMQ Nodes, the VM Size will be configurable as the Sandbox Zone lends itself well to Burstable Compute instead of General Purpose.

## Data Warehouse

Airbyte and Prefect have recently been refactored and now fit well with the Environments Module, much like AKS this should be configured in a way where by VMs are not created unless requested.